<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tic Tac Toe</title>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background: #0f172a;
      color: #e2e8f0;
    }

    .container {
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, #38bdf8, #818cf8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .status {
      font-size: 1.25rem;
      margin-bottom: 1.5rem;
      height: 2rem;
      color: #94a3b8;
    }

    .status .highlight {
      font-weight: 700;
    }

    .status .x-color {
      color: #38bdf8;
    }

    .status .o-color {
      color: #f472b6;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
      width: 330px;
      height: 330px;
      margin: 0 auto 1.5rem;
      background: #1e293b;
      border-radius: 12px;
      padding: 6px;
    }

    .cell {
      background: #0f172a;
      border: 2px solid #334155;
      border-radius: 8px;
      font-size: 3rem;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, border-color 0.15s, transform 0.1s;
      user-select: none;
    }

    .cell:hover:not(.taken) {
      background: #1e293b;
      border-color: #475569;
      transform: scale(1.03);
    }

    .cell:active:not(.taken) {
      transform: scale(0.97);
    }

    .cell.taken {
      cursor: default;
    }

    .cell.x {
      color: #38bdf8;
    }

    .cell.o {
      color: #f472b6;
    }

    .cell.winning {
      background: #1e293b;
      border-color: #22c55e;
      animation: glow 1s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { box-shadow: 0 0 5px rgba(34, 197, 94, 0.3); }
      to   { box-shadow: 0 0 20px rgba(34, 197, 94, 0.5); }
    }

    .cell.pop {
      animation: pop 0.25s ease-out;
    }

    @keyframes pop {
      0%   { transform: scale(0.5); opacity: 0; }
      80%  { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    .controls {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    button {
      padding: 0.6rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      border: 2px solid #334155;
      border-radius: 8px;
      background: #1e293b;
      color: #e2e8f0;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
    }

    button:hover {
      background: #334155;
      border-color: #475569;
    }

    button.active {
      border-color: #818cf8;
      background: #1e1b4b;
    }

    .scoreboard {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 1.5rem;
      font-size: 1.1rem;
    }

    .score-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.2rem;
    }

    .score-item .label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #64748b;
    }

    .score-item .value {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .score-item .value.x-color { color: #38bdf8; }
    .score-item .value.o-color { color: #f472b6; }
    .score-item .value.draw-color { color: #94a3b8; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Tic Tac Toe</h1>

    <div class="scoreboard">
      <div class="score-item">
        <span class="label">X Wins</span>
        <span class="value x-color" id="score-x">0</span>
      </div>
      <div class="score-item">
        <span class="label">Draws</span>
        <span class="value draw-color" id="score-draw">0</span>
      </div>
      <div class="score-item">
        <span class="label">O Wins</span>
        <span class="value o-color" id="score-o">0</span>
      </div>
    </div>

    <div class="status" id="status">
      <span class="highlight x-color">X</span>'s turn
    </div>

    <div class="board" id="board"></div>

    <div class="controls">
      <button id="btn-pvp" class="active" onclick="setMode('pvp')">2 Players</button>
      <button id="btn-ai" onclick="setMode('ai')">vs Computer</button>
      <button onclick="resetGame()">New Game</button>
      <button onclick="resetScores()">Reset Scores</button>
    </div>
  </div>

  <script>
    const WINNING_LINES = [
      [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
      [0, 3, 6], [1, 4, 7], [2, 5, 8], // cols
      [0, 4, 8], [2, 4, 6],            // diagonals
    ];

    let board = Array(9).fill(null);
    let currentPlayer = "X";
    let gameOver = false;
    let mode = "pvp"; // "pvp" or "ai"
    let scores = { X: 0, O: 0, draw: 0 };

    const boardEl = document.getElementById("board");
    const statusEl = document.getElementById("status");

    function createBoard() {
      boardEl.innerHTML = "";
      for (let i = 0; i < 9; i++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        cell.dataset.index = i;
        cell.addEventListener("click", () => handleClick(i));
        boardEl.appendChild(cell);
      }
    }

    function handleClick(index) {
      if (gameOver || board[index]) return;
      if (mode === "ai" && currentPlayer === "O") return;

      makeMove(index);

      if (!gameOver && mode === "ai" && currentPlayer === "O") {
        setTimeout(aiMove, 300);
      }
    }

    function makeMove(index) {
      board[index] = currentPlayer;
      const cell = boardEl.children[index];
      cell.textContent = currentPlayer;
      cell.classList.add("taken", currentPlayer.toLowerCase(), "pop");

      const winner = checkWinner();
      if (winner) {
        gameOver = true;
        highlightWin(winner.line);
        scores[winner.player]++;
        updateScores();
        setStatus(`<span class="highlight ${winner.player.toLowerCase()}-color">${winner.player}</span> wins!`);
        return;
      }

      if (board.every(cell => cell !== null)) {
        gameOver = true;
        scores.draw++;
        updateScores();
        setStatus("It's a draw!");
        return;
      }

      currentPlayer = currentPlayer === "X" ? "O" : "X";
      setStatus(`<span class="highlight ${currentPlayer.toLowerCase()}-color">${currentPlayer}</span>'s turn`);
    }

    function checkWinner() {
      for (const line of WINNING_LINES) {
        const [a, b, c] = line;
        if (board[a] && board[a] === board[b] && board[a] === board[c]) {
          return { player: board[a], line };
        }
      }
      return null;
    }

    function highlightWin(line) {
      for (const i of line) {
        boardEl.children[i].classList.add("winning");
      }
    }

    function setStatus(html) {
      statusEl.innerHTML = html;
    }

    function updateScores() {
      document.getElementById("score-x").textContent = scores.X;
      document.getElementById("score-o").textContent = scores.O;
      document.getElementById("score-draw").textContent = scores.draw;
    }

    // --- AI (Minimax) ---
    function aiMove() {
      if (gameOver) return;
      const best = minimax(board.slice(), "O");
      makeMove(best.index);
    }

    function minimax(state, player) {
      const available = state.reduce((acc, v, i) => (v === null ? [...acc, i] : acc), []);

      const winner = checkState(state);
      if (winner === "O") return { score: 10 };
      if (winner === "X") return { score: -10 };
      if (available.length === 0) return { score: 0 };

      const moves = [];
      for (const i of available) {
        const move = { index: i };
        state[i] = player;
        const result = minimax(state, player === "O" ? "X" : "O");
        move.score = result.score;
        state[i] = null;
        moves.push(move);
      }

      if (player === "O") {
        return moves.reduce((best, m) => (m.score > best.score ? m : best), { score: -Infinity });
      } else {
        return moves.reduce((best, m) => (m.score < best.score ? m : best), { score: Infinity });
      }
    }

    function checkState(state) {
      for (const [a, b, c] of WINNING_LINES) {
        if (state[a] && state[a] === state[b] && state[a] === state[c]) {
          return state[a];
        }
      }
      return null;
    }

    // --- Controls ---
    function setMode(m) {
      mode = m;
      document.getElementById("btn-pvp").classList.toggle("active", m === "pvp");
      document.getElementById("btn-ai").classList.toggle("active", m === "ai");
      resetGame();
    }

    function resetGame() {
      board = Array(9).fill(null);
      currentPlayer = "X";
      gameOver = false;
      createBoard();
      setStatus(`<span class="highlight x-color">X</span>'s turn`);
    }

    function resetScores() {
      scores = { X: 0, O: 0, draw: 0 };
      updateScores();
      resetGame();
    }

    // Init
    createBoard();
  </script>
</body>
</html>
